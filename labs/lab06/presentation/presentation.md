---
lang: ru-RU
title: Лабораторная работа №6
subtitle: Адресация IPv4 и IPv6. Двойной стек
author:
  - Авдадаев Джамал Геланиевич
date: 19 декабря 2025
aspectratio: 169
slide_level: 2
section-titles: true
theme: metropolis
---

# Цель работы

## Основная цель

Изучение принципов распределения и настройки адресного пространства  
на устройствах сети:

- разбиение IPv4 (VLSM)
- разбиение IPv6 (префиксы и диапазоны)
- настройка **Dual Stack** в GNS3
- проверка связности и анализ трафика (ARP / ICMP / ICMPv6)

# Dual Stack в GNS3

## Топология и именование

- Использованы:
  - VPCS: PC1–PC4
  - коммутаторы
  - маршрутизатор **FRR** (IPv4)
  - маршрутизатор **VyOS** (IPv6)
  - сервер (Dual Stack)

![Топология в GNS3](Screenshot_1.png){ width=72% }

# Настройка IPv4: конечные узлы

## Адресация (фрагмент)

- **PC1:** `172.16.20.10/25`, GW `172.16.20.1`
- **PC2:** `172.16.20.138/25`, GW `172.16.20.129`
- **Server:** `64.100.1.10/24`, GW `64.100.1.1`

![IPv4 на PC1](Screenshot_2.png){ width=72% }

## Проверка настройки (пример)

- корректность адреса/маски/шлюза
- сохранение конфигурации на узлах

![IPv4 на PC2](Screenshot_3.png){ width=72% }

# Настройка FRR (IPv4-маршрутизация)

## Конфигурация и контроль

- назначены IPv4 на интерфейсы LAN
- интерфейсы подняты
- конфигурация сохранена

![Настройка FRR](Screenshot_5.png){ width=72% }

## Проверка (show / состояние интерфейсов)

- адреса присутствуют
- интерфейсы активны
- маршрутизация готова к тестам

![Проверка FRR](Screenshot_6.png){ width=72% }

## Ping / Trace

- PC1 → PC2: ответы получены, маршрут через шлюз
- PC1 → Server: доставка успешна, межсетевой обмен корректен

![PC1 ↔ PC2](Screenshot_7.png){ width=72% }

## Доступ к серверу

- подтверждена корректная маршрутизация между подсетями IPv4

![PC1 ↔ Server](Screenshot_8.png){ width=72% }

## Назначение адресов (вручную)

- **PC3:** `2001:db8:c0de:12::a/64`
- **PC4:** `2001:db8:c0de:13::a/64`
- **Server (Dual Stack):** `2001:db8:c0de:11::a/64`

![IPv6 на PC3](Screenshot_9.png){ width=72% }

## Сервер в режиме Dual Stack

- IPv4 и IPv6 активны одновременно
- сервер доступен из обеих сред (при наличии маршрутизации)

![IPv4+IPv6 на Server](Screenshot_11.png){ width=72% }

## Настройка VyOS (IPv6-маршрутизация)

- имя устройства
- IPv6-адреса на `eth0/eth1/eth2`
- Router Advertisement для распространения префиксов в сегментах

![VyOS: IPv6 и RA](Screenshot_12.png){ width=72% }

## Контроль состояния

- интерфейсы активны
- IPv6-адреса назначены корректно

![Проверка VyOS](Screenshot_13.png){ width=72% }

## Ping / Trace

- PC3 → PC4: ответы получены, маршрут через VyOS
- PC3 → Server: доставка успешна

![PC3 ↔ PC4](Screenshot_14.png){ width=72% }

## Изоляция IPv4 и IPv6 сегментов

- PC4 (IPv6-сегмент) не обращается к IPv4-узлам
- доступ к Dual Stack Server по IPv6 — успешен

![Изоляция и доступ к Dual Stack](Screenshot_16.png){ width=72% }

## ARP (IPv4)

- разрешение `IP → MAC` в канальном сегменте
- пример: запрос от шлюза `64.100.1.1` к серверу `64.100.1.10`
- подтверждает L2-соседство и работу шлюза

![ARP-трафик](Screenshot_17.png){ width=72% }

## ICMP (IPv4)

- Echo Request / Reply
- по TTL видно прохождение маршрутизатора
- подтверждает корректную маршрутизацию IPv4 между подсетями

![ICMP-трафик IPv4](Screenshot_18.png){ width=72% }

## ICMPv6 (IPv6)

- Echo Request / Reply (диагностика)
- Neighbor Solicitation / Advertisement (аналог ARP)
- Hop Limit — аналог TTL

![ICMPv6-трафик](Screenshot_19.png){ width=72% }

# Самостоятельное задание (2 подсети)

## Адресное пространство

- Подсеть 1:
  - IPv4: `10.10.1.96/27` (30 хостов)
  - IPv6: `2001:db8:1:1::/64`
- Подсеть 2:
  - IPv4: `10.10.1.16/28` (14 хостов)
  - IPv6: `2001:db8:1:4::/64`

![Топология (самост.)](Screenshot_20.png){ width=72% }

## Таблица адресации (минимальные адреса для роутера)

- Router / Subnet 1:
  - IPv4 `10.10.1.97/27`
  - IPv6 `2001:db8:1:1::1/64`
- Router / Subnet 2:
  - IPv4 `10.10.1.17/28`
  - IPv6 `2001:db8:1:4::1/64`
- PC1:
  - IPv4 `10.10.1.100/27`, GW `10.10.1.97`
  - IPv6 `2001:db8:1:1::a/64`
- PC2:
  - IPv4 `10.10.1.20/28`, GW `10.10.1.17`
  - IPv6 `2001:db8:1:4::a/64`

## Проверка связности (IPv4/IPv6)

- PC1 → PC2 (IPv4): успешный ping, маршрут через шлюз
- PC1 → PC2 (IPv6): успешный ping/trace через IPv6-интерфейс роутера

![Ping/Trace IPv4](Screenshot_25.png){ width=72% }

# Итоги работы

## Выводы

- Выполнено разбиение IPv4 и IPv6 сетей с расчётом диапазонов
- Настроен **Dual Stack**-сервер и маршрутизация:
  - FRR для IPv4
  - VyOS для IPv6 (+ Router Advertisement)
- Подтверждена связность и корректная маршрутизация
- Проанализированы:
  - ARP (IPv4)
  - ICMP (IPv4)
  - ICMPv6 + Neighbor Discovery (IPv6)

