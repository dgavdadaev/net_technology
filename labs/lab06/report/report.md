---
## Front matter
title: "Отчёт по лабораторной работе №6"
subtitle: "Адресация IPv4 и IPv6. Двойной стек"
author: "Авдадаев Джамал Геланиевич"

## Generic otions
lang: ru-RU
toc-title: "Содержание"

## Bibliography
bibliography: bib/cite.bib
csl: pandoc/csl/gost-r-7-0-5-2008-numeric.csl

## Pdf output format
toc: true
toc-depth: 2
lof: true
lot: true
fontsize: 12pt
linestretch: 1.5
papersize: a4
documentclass: scrreprt
## I18n polyglossia
polyglossia-lang:
  name: russian
  options:
    - spelling=modern
    - babelshorthands=true
polyglossia-otherlangs:
  name: english
## I18n babel
babel-lang: russian
babel-otherlangs: english
## Fonts
mainfont: IBM Plex Serif
romanfont: IBM Plex Serif
sansfont: IBM Plex Sans
monofont: IBM Plex Mono
mathfont: STIX Two Math
mainfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
romanfontoptions: Ligatures=Common,Ligatures=TeX,Scale=0.94
sansfontoptions: Ligatures=Common,Ligatures=TeX,Scale=MatchLowercase,Scale=0.94
monofontoptions: Scale=MatchLowercase,Scale=0.94,FakeStretch=0.9
mathfontoptions:
## Biblatex
biblatex: true
biblio-style: "gost-numeric"
biblatexoptions:
  - parentracker=true
  - backend=biber
  - hyperref=auto
  - language=auto
  - autolang=other*
  - citestyle=gost-numeric
## Pandoc-crossref LaTeX customization
figureTitle: "Рис."
tableTitle: "Таблица"
listingTitle: "Листинг"
lofTitle: "Список иллюстраций"
lotTitle: "Список таблиц"
lolTitle: "Листинги"
## Misc options
indent: true
header-includes:
  - \usepackage{indentfirst}
  - \usepackage{float}
  - \floatplacement{figure}{H}
---

# Цель работы

Изучение принципов распределения и настройки адресного пространства на устройствах сети.

# Выполнение задания

## Разбиение IPv4-сети 172.16.20.0/24

### Характеристика исходной сети

- Адрес сети: `172.16.20.0/24`
- Префикс: `/24`
- Маска подсети: `255.255.255.0`
- Broadcast-адрес: `172.16.20.255`
- Диапазон адресов узлов: `172.16.20.1 – 172.16.20.254`
- Общее количество адресов: `256`
- Количество пригодных адресов узлов: `254`
- Число подсетей (без дальнейшего разбиения): `1`

### Разбиение на подсети (VLSM)

Требуется получить три подсети с максимально возможным числом узлов:
- 126 узлов
- 62 узла
- 62 узла

Для этого используются подсети `/25` и `/26`.

#### Подсеть 1 (126 узлов)

- Адрес сети: `172.16.20.0/25`
- Префикс: `/25`
- Маска: `255.255.255.128`
- Диапазон узлов: `172.16.20.1 – 172.16.20.126`
- Broadcast-адрес: `172.16.20.127`
- Количество узлов: `126`

#### Подсеть 2 (62 узла)

- Адрес сети: `172.16.20.128/26`
- Префикс: `/26`
- Маска: `255.255.255.192`
- Диапазон узлов: `172.16.20.129 – 172.16.20.190`
- Broadcast-адрес: `172.16.20.191`
- Количество узлов: `62`

#### Подсеть 3 (62 узла)

- Адрес сети: `172.16.20.192/26`
- Префикс: `/26`
- Маска: `255.255.255.192`
- Диапазон узлов: `172.16.20.193 – 172.16.20.254`
- Broadcast-адрес: `172.16.20.255`
- Количество узлов: `62`

## Разбиение IPv4-сети 10.10.1.64/26

### Характеристика исходной сети

- Адрес сети: `10.10.1.64/26`
- Префикс: `/26`
- Маска подсети: `255.255.255.192`
- Broadcast-адрес: `10.10.1.127`
- Диапазон адресов узлов: `10.10.1.65 – 10.10.1.126`
- Общее количество адресов: `64`
- Количество пригодных адресов узлов: `62`
- Число возможных подсетей `/26` в сети `/24`: `4`

### Выделение подсети на 30 узлов

Для размещения 30 узлов требуется подсеть `/27`.

#### Выделенная подсеть

- Адрес сети: `10.10.1.64/27`
- Префикс: `/27`
- Маска: `255.255.255.224`
- Диапазон узлов: `10.10.1.65 – 10.10.1.94`
- Broadcast-адрес: `10.10.1.95`
- Количество узлов: `30`

## Разбиение IPv4-сети 10.10.1.0/26

### Характеристика исходной сети

- Адрес сети: `10.10.1.0/26`
- Префикс: `/26`
- Маска подсети: `255.255.255.192`
- Broadcast-адрес: `10.10.1.63`
- Диапазон адресов узлов: `10.10.1.1 – 10.10.1.62`
- Общее количество адресов: `64`
- Количество пригодных адресов узлов: `62`
- Число возможных подсетей `/26` в сети `/24`: `4`

### Выделение подсети на 14 узлов

Для размещения 14 узлов требуется подсеть `/28`.

#### Выделенная подсеть

- Адрес сети: `10.10.1.16/28`
- Префикс: `/28`
- Маска: `255.255.255.240`
- Диапазон узлов: `10.10.1.17 – 10.10.1.30`
- Broadcast-адрес: `10.10.1.31`
- Количество узлов: `14`

## Разбиение IPv6-сети 2001:db8:c0de::/48

### Характеристика исходной сети

- IPv6-сеть: `2001:db8:c0de::/48`
- Префикс: `/48`
- Маска (в двоичном виде): 48 единиц + 80 нулей  
  (в IPv6 обычно используют запись префиксом, а не десятичную маску)
- Структура адреса при типовом разбиении:
  - первые 48 бит — **глобальный префикс (Global Routing Prefix)**: `2001:db8:c0de`
  - следующие 16 бит — **идентификатор подсети (Subnet ID)** (обычно именно тут “делают подсети”)
  - последние 64 бита — **идентификатор интерфейса (Interface ID)**

### Диапазон адресов узлов (краевые значения)

Для префикса `/48` фиксированы первые 48 бит, остальная часть (80 бит) может меняться.

- Минимальный адрес в сети: `2001:db8:c0de:0000:0000:0000:0000:0000`
- Максимальный адрес в сети: `2001:db8:c0de:ffff:ffff:ffff:ffff:ffff`

В краткой записи:
- Минимум: `2001:db8:c0de::`
- Максимум: `2001:db8:c0de:ffff:ffff:ffff:ffff:ffff`

> В IPv6 нет broadcast-адреса, поэтому “последний адрес” не зарезервирован под broadcast так, как в IPv4.

### Способ A: разбиение на 2 подсети с использованием **идентификатора подсети (Subnet ID)**

Идея: увеличить длину префикса, забрав 1 бит из поля Subnet ID.  
`/48` → `/49` даёт ровно **2 подсети**.

**Подсеть A1:** `2001:db8:c0de:0000::/49`  
- Диапазон (краевые):
  - минимум: `2001:db8:c0de:0000:0000:0000:0000:0000`
  - максимум: `2001:db8:c0de:7fff:ffff:ffff:ffff:ffff`

**Подсеть A2:** `2001:db8:c0de:8000::/49`  
- Диапазон (краевые):
  - минимум: `2001:db8:c0de:8000:0000:0000:0000:0000`
  - максимум: `2001:db8:c0de:ffff:ffff:ffff:ffff:ffff`

**Пояснение:**  
В этом варианте подсети формируются “правильно” с точки зрения классической IPv6-иерархии: глобальный префикс `/48` делится на подсети за счёт Subnet ID (следующие 16 бит). Такой подход сохраняет каноничную структуру `/64` внутри каждой подсети (в дальнейшем можно выделять /64 для L2-сегментов).

### Способ B: разбиение на 2 подсети с использованием **идентификатора интерфейса (Interface ID)**

Идея: “сделать подсети” за счёт битов, которые обычно принадлежат Interface ID.  
Для двух подсетей достаточно добавить 1 бит к префиксу: `/48` → `/49`, но интерпретировать этот дополнительный бит как взятый из области Interface ID.

Формально получаются те же по диапазонам две `/49` сети, но смысл другой:
- Подсеть B1: `2001:db8:c0de:0000::/49`
- Подсеть B2: `2001:db8:c0de:8000::/49`

**Пояснение (важное):**
- В IPv6 типовая практика — давать **/64 на один L2-сегмент**, чтобы устройства могли использовать SLAAC и стандартные механизмы ND.
- “Дробление” за счёт Interface ID ухудшает совместимость (SLAAC ожидает /64; более короткие/длинные префиксы могут работать, но это уже нестандартная практика и иногда ломает автоконфигурацию или отдельные реализации).
- Поэтому такой вариант допустим как теоретическое разбиение адресного пространства, но для реальных локальных сегментов почти всегда придерживаются `/64`.

## Разбиение IPv6-сети 2a02:6b8::/64

### Характеристика исходной сети

- IPv6-сеть: `2a02:6b8::/64`
- Префикс: `/64`
- Структура адреса:
  - первые 64 бита — префикс сети (включая Subnet ID)
  - последние 64 бита — Interface ID (идентификатор интерфейса)

### Диапазон адресов узлов (краевые значения)

- Минимальный адрес: `2a02:6b8:0000:0000:0000:0000:0000:0000`
- Максимальный адрес: `2a02:6b8:0000:0000:ffff:ffff:ffff:ffff`

В краткой записи:
- Минимум: `2a02:6b8::`
- Максимум: `2a02:6b8::ffff:ffff:ffff:ffff`

### Способ A: разбиение на 2 подсети с использованием **идентификатора подсети (Subnet ID)**

Здесь нюанс: при `/64` Subnet ID уже “внутри” первых 64 бит (обычно это 4-й хекстет).  
Чтобы получить 2 подсети, увеличиваем префикс на 1 бит: `/64` → `/65`.

**Подсеть A1:** `2a02:6b8::/65`  
- Диапазон (краевые):
  - минимум: `2a02:6b8::`
  - максимум: `2a02:6b8:0:0:7fff:ffff:ffff:ffff`

**Подсеть A2:** `2a02:6b8:0:0:8000::/65`  
- Диапазон (краевые):
  - минимум: `2a02:6b8:0:0:8000:0000:0000:0000`
  - максимум: `2a02:6b8:0:0:ffff:ffff:ffff:ffff`

**Пояснение:**  
Формально это разбиение корректно с точки зрения префиксов маршрутизации. Однако для L2-сетей `/65` применять нежелательно, поскольку SLAAC и множество практик ожидают `/64`.

### Способ B: разбиение на 2 подсети с использованием **идентификатора интерфейса (Interface ID)**

Идея: оставить префикс `/64` неизменным, но логически “разделить” адреса на две группы по старшему биту Interface ID:

- “Подсеть” B1: все адреса, где старший бит Interface ID = 0  
  Диапазон: `2a02:6b8::` – `2a02:6b8::7fff:ffff:ffff:ffff`

- “Подсеть” B2: все адреса, где старший бит Interface ID = 1  
  Диапазон: `2a02:6b8::8000:0000:0000:0000` – `2a02:6b8::ffff:ffff:ffff:ffff`

**Пояснение:**
- Это именно **логическое** разбиение: с точки зрения маршрутизации и ND это всё равно одна и та же сеть `/64`.
- Такой подход можно использовать для внутреннего планирования адресов (например, “половина диапазона под серверы, половина под клиентов”), но это не создаёт отдельных подсетей в сетевом смысле.
- Если действительно нужны две независимые IPv6-подсети, то правильнее использовать разные `/64` (то есть иметь исходно префикс короче, например `/63`, чтобы разделить на два `/64`).

## Настройка двойного стека адресации IPv4 и IPv6 в локальной сети

После запуска **GNS3 VM** и клиента **GNS3** был создан новый проект. В рабочем пространстве размещены и соединены устройства в соответствии с заданной топологией: узлы VPCS (PC1–PC4), коммутаторы, маршрутизатор **FRR** для подсети IPv4 и маршрутизатор **VyOS** для сегмента IPv6.

Сформированная топология и взаимное расположение устройств представлены на рисунке ниже.

![Собранная топология в GNS3](Screenshot_1.png)

В соответствии с требованиями методических указаний были изменены отображаемые имена всех элементов схемы. Именование выполнено по следующим правилам:

- коммутаторы — **msk-dgavdadaev-sw-0x**;
- маршрутизаторы — **msk-dgavdadaev-gw-0x**;
- узлы VPCS — **PCx-dgavdadaev**;
- сервер — **server-dgavdadaev**.

Применённая схема именования обеспечивает однозначную идентификацию устройств и упрощает анализ топологии.

Для анализа сетевого взаимодействия был включён захват трафика на канале между узлом **server-dgavdadaev** и ближайшим к нему коммутатором. Это позволяет наблюдать процесс обмена пакетами при проверке связности между сегментами сети.

### Настройка IPv4-адресации на конечных узлах

Согласно таблице 6.6 выполнена настройка IPv4-адресации на узлах **PC1**, **PC2** и **server-dgavdadaev**. Для каждого устройства был задан IP-адрес, маска подсети и шлюз по умолчанию, после чего конфигурация сохранена. Корректность параметров проверена выводом текущих сетевых настроек.

На узле **PC1-dgavdadaev** назначен IPv4-адрес `172.16.20.10/25` со шлюзом по умолчанию `172.16.20.1`. Результат настройки подтверждён просмотром параметров интерфейса.

![Параметры IPv4 на PC1](Screenshot_2.png)

На узле **PC2-dgavdadaev** назначен IPv4-адрес `172.16.20.138/25` со шлюзом по умолчанию `172.16.20.129`. Настройки успешно сохранены и подтверждены просмотром конфигурации.

![Параметры IPv4 на PC2](Screenshot_3.png)

На узле **server-dgavdadaev** настроен IPv4-адрес `64.100.1.10/24` и шлюз `64.100.1.1`. Конфигурация сохранена и проверена стандартными диагностическими средствами.

![Параметры IPv4 на Server](Screenshot_4.png)

Дополнительно на узлах PC1 и PC2 выполнен просмотр параметров IPv4 и IPv6 для контроля текущего состояния сетевой конфигурации.

### Настройка IPv4-адресации на маршрутизаторе FRR

Для маршрутизации между подсетями `172.16.20.0/25`, `172.16.20.128/25` и сетью сервера `64.100.1.0/24` выполнена настройка маршрутизатора **msk-dgavdadaev-gw-01** на базе FRR.

В процессе конфигурирования задано имя устройства и назначены IPv4-адреса на интерфейсах локальной сети. Все используемые интерфейсы переведены в рабочее состояние, после чего конфигурация сохранена во внутреннем хранилище.

Фрагмент выполненной настройки представлен на рисунке ниже.

![Настройка интерфейсов маршрутизатора FRR](Screenshot_5.png)

Для контроля корректности выполненных настроек произведён просмотр текущей конфигурации и состояния интерфейсов маршрутизатора. Проверка подтвердила наличие заданных IPv4-адресов и активное состояние интерфейсов, участвующих в маршрутизации.

Результаты проверки приведены на рисунке ниже.

![Проверка конфигурации и интерфейсов FRR](Screenshot_6.png)

### Проверка сетевой связности

После завершения настройки адресации и маршрутизатора выполнена проверка связности сети с использованием диагностических средств ICMP.

С узла **PC1-dgavdadaev** выполнена проверка доступности узла **PC2-dgavdadaev**. Эхо-запросы успешно доставляются до целевого узла, а трассировка маршрута подтверждает прохождение пакетов через шлюз маршрутизатора.

![Проверка связи PC1 – PC2](Screenshot_7.png)

С узла **PC1-dgavdadaev** выполнена проверка доступности сервера **server-dgavdadaev**. Результаты показывают успешную доставку пакетов и корректную маршрутизацию между подсетями.

![Проверка связи PC1 – Server](Screenshot_8.png)

### Настройка IPv6-адресации на узлах PC3, PC4 и Server

На следующем этапе лабораторной работы выполнена настройка IPv6-адресации для узлов, входящих в IPv6-подсеть, в соответствии с таблицей 6.6. Адресация назначалась вручную на каждом узле VPCS с последующим сохранением конфигурации и проверкой параметров.

На узле **PC3-dgavdadaev** был назначен глобальный IPv6-адрес  
`2001:db8:c0de:12::a/64`. После сохранения конфигурации выполнен просмотр текущих IPv6-параметров. В выводе отображаются link-local и global IPv6-адреса интерфейса.

Результат настройки представлен на рисунке ниже.

![Настройка IPv6 на PC3 и проверка show ipv6](Screenshot_9.png)

На узле **PC4-dgavdadaev** был назначен глобальный IPv6-адрес  
`2001:db8:c0de:13::a/64`. Конфигурация сохранена, после чего выполнен просмотр IPv6-настроек, подтверждающий корректное назначение адреса.

Результат настройки представлен на рисунке ниже.

![Настройка IPv6 на PC4 и проверка show ipv6](Screenshot_10.png)

На узле **server-dgavdadaev** дополнительно к ранее настроенной IPv4-адресации был назначен IPv6-адрес  
`2001:db8:c0de:11::a/64`. Таким образом сервер функционирует в режиме двойного стека (Dual Stack), поддерживая одновременную работу с IPv4 и IPv6.

Результаты просмотра IPv4 и IPv6 параметров сервера представлены на рисунке ниже.

![IPv4 и IPv6 адресация на сервере двойного стека](Screenshot_11.png)

На узлах **PC3-dgavdadaev** и **PC4-dgavdadaev** выполнен просмотр текущих параметров IPv4 и IPv6. Проверка показала, что IPv4-адреса на данных узлах отсутствуют, в то время как IPv6-адреса назначены корректно и соответствуют заданным подсетям.

### Настройка IPv6-адресации на маршрутизаторе VyOS

Для маршрутизации IPv6-трафика между подсетями `2001:db8:c0de:12::/64`,  
`2001:db8:c0de:13::/64` и `2001:db8:c0de:11::/64` выполнена настройка маршрутизатора **VyOS msk-dgavdadaev-gw-02**.

В процессе работы была выполнена установка системы VyOS с последующей перезагрузкой устройства. После этого в режиме конфигурирования задано имя маршрутизатора и сохранены изменения.

Далее на интерфейсах маршрутизатора назначены IPv6-адреса и настроен сервис Router Advertisement для автоматического распространения префиксов в соответствующих сегментах сети.

Фрагмент процесса конфигурирования и сравнение изменений представлены на рисунке ниже.

![Назначение IPv6-адресов и Router Advertisement на VyOS](Screenshot_12.png)

После применения изменений конфигурация маршрутизатора сохранена. Для контроля корректности настроек выполнен просмотр состояния интерфейсов и назначенных IPv6-адресов.

Результаты проверки подтверждают, что интерфейсы `eth0`, `eth1` и `eth2` активны и имеют корректные IPv6-адреса. Вывод представлен на рисунке ниже.

![Проверка IPv6-интерфейсов маршрутизатора VyOS](Screenshot_13.png)

### Проверка связности в IPv6-сети

После завершения настройки IPv6-адресации выполнена проверка сетевой связности между узлами IPv6-сегмента с использованием эхо-запросов и трассировки маршрута.

С узла **PC3-dgavdadaev** выполнена проверка доступности узла **PC4-dgavdadaev** по IPv6-адресу. Эхо-запросы успешно доставляются, а трассировка подтверждает прохождение трафика через маршрутизатор VyOS.

Результаты проверки представлены на рисунке ниже.

![Ping и trace между PC3 и PC4 по IPv6](Screenshot_14.png)

С узла **PC3-dgavdadaev** выполнена проверка доступности сервера **server-dgavdadaev** по IPv6. Результаты показывают успешную маршрутизацию IPv6-трафика и корректную работу маршрутизатора VyOS.

![Ping и trace PC3 – Server по IPv6](Screenshot_15.png)

На завершающем этапе выполнена проверка изоляции подсетей IPv4 и IPv6. Узел **PC4-dgavdadaev**, находящийся в IPv6-сегменте, не имеет доступа к узлам IPv4-сети, что подтверждается отсутствием ответа при попытках обращения по IPv4-адресам.

В то же время обращение к серверу двойного стека по IPv6 выполняется успешно, что соответствует требованиям задания.

Результаты проверки представлены на рисунке ниже.

![Проверка недоступности IPv4 из IPv6 и доступ к Dual Stack Server](Screenshot_16.png)

## Анализ перехваченного трафика ARP, ICMP и ICMPv6

На завершающем этапе лабораторной работы был проанализирован сетевой трафик, захваченный на соединении между **сервером двойного стека адресации** и ближайшим к нему коммутатором. Захват выполнялся в процессе проверки связности, что позволило наблюдать работу протоколов разрешения адресов и диагностики сети для IPv4 и IPv6.

В перехваченном трафике зафиксированы пакеты протокола **ARP**, используемого в IPv4 focusing для сопоставления IP-адресов с MAC-адресами.

В ARP-запросе видно, что узел с IP-адресом `64.100.1.1` (шлюз по умолчанию) запрашивает MAC-адрес узла `64.100.1.10` (сервер). В поле *Sender IP address* указывается IP-адрес отправителя запроса, а поле *Target IP address* содержит IP-адрес искомого узла. Отсутствие MAC-адреса в запросе указывает на необходимость его разрешения.

В ответном ARP-пакете передаётся информация о соответствии IP-адреса `64.100.1.10` его физическому MAC-адресу. Таким образом, из ARP-трафика можно извлечь следующие данные:

- соответствие IPv4-адресов и MAC-адресов узлов;
- факт нахождения устройств в одном канальном сегменте;
- участие шлюза в передаче трафика между подсетями.

Фрагменты ARP-пакетов представлены на рисунке ниже.

![Анализ ARP-трафика](Screenshot_17.png)

В перехваченном IPv4-трафике зафиксированы пакеты протокола **ICMP**, используемые для диагностики соединений (эхо-запросы и эхо-ответы).

Из ICMP-пакетов можно определить:

- IP-адрес источника (`64.100.1.10`) и назначения (`172.16.20.138`);
- тип сообщения (Echo Request и Echo Reply);
- идентификатор и номер последовательности, позволяющие сопоставлять запросы и ответы;
- значение поля **TTL**, уменьшающееся при прохождении маршрутизатора, что подтверждает факт маршрутизации трафика между подсетями.

Анализ ICMP-трафика подтверждает корректную маршрутизацию IPv4-пакетов между узлами сети через маршрутизатор FRR. Пример перехваченных ICMP-пакетов представлен на рисунке ниже.

![Анализ ICMP-трафика IPv4](Screenshot_18.png)

Для IPv6-сегмента сети в перехваченном трафике присутствуют пакеты **ICMPv6**, выполняющие как диагностические, так и служебные функции.

В трафике наблюдаются следующие типы ICMPv6-сообщений:

- Echo Request и Echo Reply — подтверждают доступность узлов по IPv6;
- Neighbor Solicitation и Neighbor Advertisement — используются для определения соответствия IPv6-адресов и MAC-адресов, являясь функциональным аналогом ARP в IPv6.

Из ICMPv6-пакетов можно извлечь:

- IPv6-адреса источника и назначения (например, `2001:db8:c0de:11::a` и `2001:db8:c0de:12::a`);
- значение **Hop Limit**, аналогичное TTL в IPv4;
- факт работы механизма Neighbor Discovery;
- корректную маршрутизацию IPv6-трафика через маршрутизатор VyOS.

Пример анализа ICMPv6-пакетов представлен на рисунке ниже.

![Анализ ICMPv6-трафика](Screenshot_19.png)

Анализ перехваченного трафика показал, что:

- ARP используется для разрешения IPv4-адресов в MAC-адреса в пределах канального сегмента;
- ICMP обеспечивает диагностику и подтверждает корректную маршрутизацию IPv4-пакетов;
- ICMPv6 выполняет как диагностические функции, так и задачи обнаружения соседей и разрешения адресов в IPv6-сети;
- сервер двойного стека корректно обрабатывает трафик как IPv4, так и IPv6, выступая связующим элементом между двумя сетевыми средами.

## Задание для самостоятельного выполнения

В рамках самостоятельного задания была использована топология сети с двумя локальными подсетями, разделёнными маршрутизатором **VyOS**. В топологии присутствуют два конечных узла (**PC1-dgavdadaev** и **PC2-dgavdadaev**), два коммутатора доступа и один маршрутизатор **msk-dgavdadaev-gw-01**, выполняющий функции шлюза по умолчанию и маршрутизации между подсетями.

Схема топологии представлена на рисунке ниже.

![Топология сети с двумя локальными подсетями](Screenshot_20.png)

### Характеристика подсетей и диапазонов адресов

Сеть разделена на две подсети, для каждой из которых задано адресное пространство IPv4 и IPv6.

* Подсеть 1

- IPv4-подсеть: `10.10.1.96/27`  
  Маска: `255.255.255.224`  
  Размер подсети: 32 адреса, из них 30 доступны для узлов.

  Диапазон адресов:
  - адрес сети: `10.10.1.96`
  - доступные адреса хостов: `10.10.1.97` – `10.10.1.126`
  - широковещательный адрес: `10.10.1.127`

- IPv6-подсеть: `2001:DB8:1:1::/64`  
  В данной подсети доступны адреса вида `2001:DB8:1:1::xxxx` (первые 64 бита фиксируют префикс, оставшиеся 64 бита используются для идентификаторов интерфейсов).

* Подсеть 2

- IPv4-подсеть: `10.10.1.16/28`  
  Маска: `255.255.255.240`  
  Размер подсети: 16 адресов, из них 14 доступны для узлов.

  Диапазон адресов:
  - адрес сети: `10.10.1.16`
  - доступные адреса хостов: `10.10.1.17` – `10.10.1.30`
  - широковещательный адрес: `10.10.1.31`

- IPv6-подсеть: `2001:DB8:1:4::/64`  
  В данной подсети доступны адреса вида `2001:DB8:1:4::xxxx`.

### Таблица адресации для заданной топологии

С учётом требования использовать **наименьший доступный адрес** в каждой подсети для интерфейсов маршрутизатора, был выбран следующий вариант адресации.

- Маршрутизатор (подсеть 1):  
  IPv4: `10.10.1.97/27` (первый доступный адрес)  
  IPv6: `2001:DB8:1:1::1/64` (условно наименьший адрес в префиксе)

- Маршрутизатор (подсеть 2):  
  IPv4: `10.10.1.17/28` (первый доступный адрес)  
  IPv6: `2001:DB8:1:4::1/64` (условно наименьший адрес в префиксе)

- PC1 (подсеть 1):  
  IPv4: `10.10.1.100/27`, шлюз `10.10.1.97`  
  IPv6: `2001:DB8:1:1::a/64`

- PC2 (подсеть 2):  
  IPv4: `10.10.1.20/28`, шлюз `10.10.1.17`  
  IPv6: `2001:DB8:1:4::a/64`

### Настройка IP-адресации на конечных узлах

Далее выполнена настройка адресации на VPCS-узлах в соответствии с выбранной таблицей.

На узле **PC1-dgavdadaev** назначены:
- IPv4-адрес `10.10.1.100/27` и шлюз `10.10.1.97`;
- IPv6-адрес `2001:db8:1:1::a/64`.

Конфигурация сохранена и применена. Фрагмент настройки представлен на рисунке ниже.

![Настройка адресации на PC1](Screenshot_21.png)

На узле **PC2-dgavdadaev** назначены:
- IPv4-адрес `10.10.1.20/28` и шлюз `10.10.1.17`;
- IPv6-адрес `2001:db8:1:4::a/64`.

Конфигурация сохранена и применена. Фрагмент настройки представлен на рисунке ниже.

![Настройка адресации на PC2](Screenshot_22.png)

### Настройка IP-адресации на маршрутизаторе VyOS

На маршрутизаторе **msk-dgavdadaev-gw-01 (VyOS)** выполнена настройка интерфейсов, подключённых к двум подсетям.

В процессе конфигурирования:

- для `eth0` назначены адреса подсети 1:  
  `10.10.1.97/27` и `2001:db8:1:1::1/64`,  
  а также настроена рассылка префикса Router Advertisement `2001:db8:1:1::/64`;

- для `eth1` назначены адреса подсети 2:  
  `10.10.1.17/28` и `2001:db8:1:4::1/64`,  
  а также настроена рассылка префикса Router Advertisement `2001:db8:1:4::/64`.

После внесения изменений выполнены команды применения и сохранения конфигурации.

Фрагмент настройки представлен на рисунке ниже.

![Настройка интерфейсов VyOS и Router Advertisement](Screenshot_23.png)

### Проверка конфигурации интерфейсов маршрутизатора

Для контроля корректности настроек выполнен просмотр состояния интерфейсов. Вывод подтверждает назначение IPv4- и IPv6-адресов на `eth0` и `eth1`.

Результат проверки представлен на рисунке ниже.

![Проверка интерфейсов VyOS](Screenshot_24.png)

### Проверка сетевой связности (ping и trace)

После настройки адресации выполнена проверка доступности узлов между собой по IPv4 и IPv6.

С узла **PC1-dgavdadaev** выполнен `ping` узла **PC2-dgavdadaev** по адресу `10.10.1.20`. Ответы получены успешно. Трассировка маршрута показывает прохождение трафика через шлюз `10.10.1.97`, что подтверждает маршрутизацию между подсетями.

Результаты проверки представлены на рисунке ниже.

![Ping и trace PC1 → PC2 по IPv4](Screenshot_25.png)

Также с узла **PC1-dgavdadaev** выполнена проверка доступности узла **PC2-dgavdadaev** по IPv6-адресу `2001:db8:1:4::a`. Эхо-запросы успешно доставляются, а трассировка подтверждает прохождение трафика через маршрутизатор (первым переходом отображается адрес интерфейса маршрутизатора `2001:db8:1:1::1`).

Результаты проверки представлены на рисунке ниже.

![Ping и trace PC1 → PC2 по IPv6](Screenshot_26.png)

# Заключение

В ходе выполнения работы были рассмотрены принципы адресации и разбиения сетей IPv4 и IPv6. На практике отработаны методы деления адресного пространства на подсети с использованием фиксированной и переменной длины префикса, а также выполнено сравнение подходов, применяемых в IPv4 и IPv6.

Для IPv4 были изучены способы расчёта масок, диапазонов адресов узлов и broadcast-адресов, а также выполнено разбиение сетей на подсети с заданным числом хостов. Для IPv6 проанализирована структура адреса, особенности отсутствия broadcast-адреса и различные варианты логического и иерархического разбиения сети с использованием идентификатора подсети и идентификатора интерфейса.

В процессе лабораторной работы была подтверждена важность корректного выбора длины префикса и соблюдения практических рекомендаций, в частности использования префикса `/64` для локальных сегментов IPv6. Полученные результаты позволяют сделать вывод о том, что грамотное планирование адресного пространства является ключевым фактором для масштабируемости, управляемости и корректной работы современных сетей.
